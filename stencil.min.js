/*! Stencil.js templating/binding engine
https://github.com/rstacruz/stencil.js
*/(function(){var a,b=[].slice;a=function(){function a(a,b,c){this.$el=a,this.model=b,this.events=this._flattenRules(c),this.memoize(this,"getSingleRunner"),this.bind()}return a.prototype.memoize=function(a,b){var c,d;return c=function(a,b,c){var d,e;return(e=c.data("uniq"))!=null?e:c.data("uniq",Math.random()),d=c.data("uniq"),[a,b,d]},d=a[b],a[b]=_.memoize(d,c)},a.prototype.bind=function(){var a,c=this;if((a=this.model)!=null?!a.on:!void 0)return;return this.unbind(),this.handlers={},_.each(this.events,function(a,d){return c.handlers[d]=function(){var a;return a=1<=arguments.length?b.call(arguments,0):[],c.run.apply(c,[d].concat(b.call(a)))},c.model.on(d,c.handlers[d])}),this},a.prototype.unbind=function(){var a,b=this;if((a=this.model)!=null?!a.off:!void 0)return;return this.handlers&&(_.each(this.handlers,function(a,c){return b.model.off(c,a)}),this.handlers=null),this},a.prototype._flattenRules=function(a){var b,c=this;return b={},_.each(a,function(a,c){var d;return d=c.split(/, */),_.each(d,function(c){var d;return(d=b[c])==null&&(b[c]={}),_.extend(b[c],a)})}),b},a.prototype.run=function(){var a,c;return c=arguments[0],a=2<=arguments.length?b.call(arguments,1):[],c==null&&(c="*"),c.indexOf("*")>-1?this.runGlob(c):(_.isArray(c)||(c=[c]),this.runDirectives(this.getDirectivesFor(c),a),this)},a.prototype.runDirectives=function(a,b,c){var d;return c==null&&(c=this.$el),d=this.getRunner(a,c),d(b)},a.prototype.getRunner=function(a,b){var c,d=this;return b==null&&(b=this.$el),c=_.map(a,function(a,c){return d.getSingleRunner(c,a,b)}),function(a){return _.each(c,function(b){return b(a)})}},a.prototype.getSingleRunner=function(a,b,c){var d,e,f;e=a.match(/^\s*([^\s]+)\s*(.*?)\s*$/);if(!e)throw"Matcher error: '"+a+"'";d=e[1],f=e[2];switch(d){case"add":e=f.match(/^(.*?)\s*>\s*([^>]+?)$/);if(!e)throw""+d+" matcher error: '"+f+"'";return this.runners.add.apply(this,[f,b,c,e[1],e[2]]);case"attr":e=f.match(/^(.*?)\s*@([A-Za-z0-9\-\_]+)$/);if(!e)throw""+d+" matcher error: '"+f+"'";return this.runners.attr.apply(this,[f,b,c,e[1],e[2]]);case"html":case"text":return this.runners["default"].apply(this,[f,b,c,d]);case"remove":e=f.match(/^(.*?)\s*>\s*([^>]+?)\s*@([A-Za-z0-9\-\_]+)\s*$/);if(!e)throw""+d+" matcher error: '"+f+"'";return this.runners.remove.apply(this,[f,b,c,e[1],e[2],e[3]]);default:throw"Unknown action: '"+d+"'"}},a.prototype.runners={"default":function(a,b,c,d){var e,f=this;return d==null&&(d="html"),e=_.bind(b,this.model),function(b){var f;return f=e.apply(null,b),console.log(a),console.log(c),console.log(c.find(a)),c.find(a)[d](f)}},attr:function(a,b,c,d,e){var f,g,h=this;return f=c,d.length&&(f=f.find(d)),g=_.bind(b,this.model),function(a){return f.attr(e,g.apply(null,a))}},add:function(a,b,c,d,e){var f,g,h=this;return f=c,d.length&&(f=f.find(d)),g=$(f.find(e)[0]).remove(),function(a){var c;return c=function(a){var c,d;return c=g.clone(),d=h.getRunner(b,c),d(a),f.append(c)},_.isArray(a[0])?_.each(a[0],function(a){return c([a])}):a[0].each?a[0].each(function(a){return c([a])}):c(a)}},remove:function(a,b,c,d,e,f){var g,h,i=this;return g=c,d.length&&(g=g.find(d)),h=_.bind(b,this.model),function(a){var b;return b=h.apply(null,a),g.find(e).filter("["+f+'="'+b+'"]').remove()}}},a.prototype.runGlob=function(a){var b;return b=_.filter(_.keys(this.events),function(b){return b.match(new RegExp("^"+a.replace("*",".*")+"$"))}),this.run(b)},a.prototype.getDirectivesFor=function(a){var b,c=this;return _.isArray(a)||(a=[a]),b={},_.each(a,function(a){if(typeof c.events[a]=="object")return _.extend(b,c.events[a])}),b},a}(),$.fn.stencil=function(){var c;return c=1<=arguments.length?b.call(arguments,0):[],function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b),f=typeof e;return f=="object"||f=="function"?e||d:d}(a,[this].concat(b.call(c)),function(){})}}).call(this)